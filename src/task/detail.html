<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui" />
    <title>Hello Coder</title>
</head>
<body>
    <div class="main">

        <div id="detail-main"></div>

        <!-- title -->
        <script id="detail-main-template" type="x-tmpl-mustache">
        <div class="layout detail-title">
            <div class="detail-title-main">
                <p class="detail-title-top">{{ title }}</p>
                <p>{{ updateDateRaw }}</p>
            </div>

            <div class="detail-title-right">
                <p class="star"><em></em></p>
                <p class="detail-title-state state-doing">{{ statusText }}</p>
            </div>
        </div>

        <div class="layout detail-comments">
            <div class="sub-title">任务描述</div>

            <p>{{ content }}</p>
            <p>紧要程度: {{ importanceRaw }}</p>
            <p>完成时间: 尽快完成</p>
        </div>

        <!-- 成员 -->
        <dl id="partner" class="layout-list partner">
            <dt class="sub-title">团队成员</dt>
            <!-- Call pub data -->
            {{#userInfoFail}}
            <dd>没有获取到人员信息</dd>
            {{/userInfoFail}}
            {{^userInfoFail}}
            <div class="loading-status">
                <span class="loading"></span>
                <span class="loading-text">加载中</span>
            </div>
            {{/userInfoFail}}
        </dl>

        <!-- 事件 & 讨论 -->
        <div class="layout-list">
            <dl id="affair-talk" class="affair-talk">
                <dt class="sub-title">事件与讨论</dt>
                <!-- 另一个异步请求获取数据 -->
            </dl>

            <div id="affair-talk-more-handler" class="load-more">
                <!-- JS create -->
            </div>
        </div>

        <!-- 附件 -->
        <dl class="layout-list attach">
            <dt class="sub-title">附件</dt>
            
            <dd>
                <div class="column-left">
                    <img src="/common/img/files/doc.png" />
                </div>
                <div class="column-middle">
                    <div class="column-inner">
                        <p>N 版设计稿</p>
                        <p class="attach-size">1.2MB</p>
                    </div>
                </div>
                <div class="column-right">
                    <em class="download"></em>
                </div>
            </dd>
        </dl>

        <!-- 底部按钮条 -->
        {{#rights}}
        <div class="fixbar">
            <ul>
                {{#audit_right}}
                <li>不同意</li>
                <li>同意</li>
                {{/audit_right}}

                {{#add_event_right}}
                <li data-page="/affair/new.html">新建事件</li>
                {{/add_event_right}}

                {{#add_talk_right}}
                <li data-page="/talk/new.html">发起讨论</li>
                {{/add_talk_right}}

                {{#apply_right}}
                <li data-page="/form/submit.html?type=0&master={{ isMaster }}">完成任务</li>
                {{/apply_right}}
            </ul>
        </div>
        {{/rights}}

        </script>

    </div>
    
    <!-- 事件和讨论 -->
    <script id="affair-talk-template" type="x-tmpl-mustache">
    {{#list}}
    <dd data-pagenum="{{ pagenum }}" tid="{{ id }}" class="affair-talk-item {{#num}}new-msg{{/num}}" data-page="{{ page }}" >
        <div class="column-left">
            [{{ type }}] {{ title }}
        </div>
        <div class="column-right">
            <div class="column-more">
                {{#num}}
                <em class="count">{{ num }}</em>
                {{/num}}
                <em class="arrow"><i></i></em>
            </div>
        </div>
    </dd>
    {{/list}}
    </script>
    
    <!-- 团队成员 -->
    <script id="partner-template" type="x-tmpl-mustache">
    <dt class="sub-title">团队成员</dt>
    {{#creator}}
    <dd>
        <div class="column-left">创建人: </div>
        <div class="column-middle">
            <div class="column-inner">
                {{ creator }}
            </div>
        </div>
    </dd>
    {{/creator}}

    {{#principal}}
    <dd>
        <div class="column-left">负责人: </div>
        <div class="column-middle">
            <div class="column-inner">
                {{ principal }}
            </div>
        </div>
    </dd>
    {{/principal}}

    {{#partnerLength}}
    <dd class="partner-more" data-jids="{{partnerJids}}">
        <div class="column-left">参与人: </div>
        <div class="column-middle">
            <div class="column-inner">
                {{partnerRaw}}
            </div>
        </div>
        <div class="column-right">
            <div class="column-more">
                {{#partnerLength}}
                <em>{{ partnerLength }}人</em>
                <em class="arrow"><i></i></em>
                {{/partnerLength}}
            </div>
        </div>
    </dd>
    {{/partnerLength}}
    </script>

    <script type="text/javascript" src="/cordova.js"></script>
</body>

</html>